

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>publish() &mdash; Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/audeering.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="remove_media()" href="audb.remove_media.html" />
    <link rel="prev" title="load_to()" href="audb.load_to.html" />
    
      
    
  

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          <a href="../index.html">
          
            <img src="../_static/images/audeering.png" class="logo" alt="audEERING"/>
          
          
            <span> audb</span>
          
          </a>

          
            
            
              <div class="version">
                v1.10.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publish.html">Publish a database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../load.html">Load a database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Database dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../caching.html">Caching</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="audb.html">audb</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="audb.config.html">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.DatabaseIterator.html">DatabaseIterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.Dependencies.html">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.Flavor.html">Flavor</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.Repository.html">Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.available.html">available()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.cached.html">cached()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.default_cache_root.html">default_cache_root()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.dependencies.html">dependencies()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.exists.html">exists()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.flavor_path.html">flavor_path()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.latest_version.html">latest_version()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.load.html">load()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.load_attachment.html">load_attachment()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.load_media.html">load_media()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.load_table.html">load_table()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.load_to.html">load_to()</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">publish()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.remove_media.html">remove_media()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.repository.html">repository()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.stream.html">stream()</a></li>
<li class="toctree-l2"><a class="reference internal" href="audb.versions.html">versions()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="audb.info.html">audb.info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">audb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="audb.html">audb</a> &raquo;</li>
      <li>publish()</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/audeering/audb/" class="fa fa-github"> GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="publish">
<h1>publish()<a class="headerlink" href="#publish" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="audb.publish">
<span class="sig-prename descclassname"><span class="pre">audb.</span></span><span class="sig-name descname"><span class="pre">publish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repository</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">archives</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous_version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/audb/core/publish.html#publish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#audb.publish" title="Permalink to this definition">¶</a></dt>
<dd><p>Publish database.</p>
<p>Publishes a database conform to <a class="reference external" href="https://audeering.github.io/audformat/data-introduction.html">audformat</a>,
stored in the <code class="docutils literal notranslate"><span class="pre">db_root</span></code> folder.</p>
<p>A database can have dependencies
to media files and tables of an older version.
E.g. you might alter an existing table
by adding labels for new media files to it
and publish it as a new version.
<a class="reference internal" href="#audb.publish" title="audb.publish"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.publish()</span></code></a> will then upload
new and altered files and update
the dependencies accordingly.</p>
<p>To update a database,
you first have to load the version
that the new version should depend on
with <a class="reference internal" href="audb.load_to.html#audb.load_to" title="audb.load_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.load_to()</span></code></a> to <code class="docutils literal notranslate"><span class="pre">db_root</span></code>.
Media files that are not altered can be omitted,
so it is recommended to set
<code class="docutils literal notranslate"><span class="pre">only_metadata=True</span></code> in <a class="reference internal" href="audb.load_to.html#audb.load_to" title="audb.load_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.load_to()</span></code></a>.
Afterwards you make your changes to that folder
and run <a class="reference internal" href="#audb.publish" title="audb.publish"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.publish()</span></code></a>.
To remove media files from a database,
make sure they are no
longer referenced in the tables.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">previous_version=None</span></code> allows you
to start from scratch and upload all files
even if an older versions exist.
In this case you don’t call <a class="reference internal" href="audb.load_to.html#audb.load_to" title="audb.load_to"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.load_to()</span></code></a>
before running <a class="reference internal" href="#audb.publish" title="audb.publish"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.publish()</span></code></a>.</p>
<p>Handling of audio formats
is based on the file extension
in <a class="reference internal" href="audb.html#module-audb" title="audb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">audb</span></code></a>.
This means the file extension must be lowercase
and should match the audio format of the file,
e.g. <code class="docutils literal notranslate"><span class="pre">.wav</span></code>.</p>
<p>When canceling <a class="reference internal" href="#audb.publish" title="audb.publish"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.publish()</span></code></a>
during publication
you can restart it afterwards.
It will continue from the current state,
but you might need overwrite permissions
in addition to write permissions
on the backend.</p>
<p><a class="reference internal" href="audb.html#module-audb" title="audb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">audb</span></code></a> uses md5 hashes of the database files
to check if they have changed.
Be aware that for certain file formats,
like parquet,
md5 hashes might differ
for files with identical content.
Reasons include the library that wrote the file,
involved compression codes,
or additional metadata written by the library.
For files stored in parquet format,
<a class="reference internal" href="#audb.publish" title="audb.publish"><code class="xref py py-func docutils literal notranslate"><span class="pre">audb.publish()</span></code></a> will first look for a hash
stored in its metadata
under the <code class="docutils literal notranslate"><span class="pre">b&quot;hash&quot;</span></code> key.
For parquet tables,
this deterministic hash
is automatically added by <a class="reference external" href="https://audeering.github.io/audformat/api/audformat.html#module-audformat" title="(in audformat vv1.3.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">audformat</span></code></a>.</p>
<p>Tables stored only as pickle files,
are converted to parquet files
before publication.
If a table is stored as a parquet and csv file,
the csv file is ignored,
and the parquet file is published.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – root directory of database</p></li>
<li><p><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – version string</p></li>
<li><p><strong>repository</strong> (<a class="reference internal" href="audb.Repository.html#audb.Repository" title="audb.core.repository.Repository"><code class="xref py py-class docutils literal notranslate"><span class="pre">Repository</span></code></a>) – name of repository</p></li>
<li><p><strong>archives</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – dictionary mapping files to archive names.
Can be used to bundle files into archives,
which will speed up communication with the server
if the database contains many small files.
Archive name must not include an extension</p></li>
<li><p><strong>previous_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – specifies the version
this publication should be based on.
If <code class="docutils literal notranslate"><span class="pre">'latest'</span></code>
it will use automatically the latest published version
or <code class="docutils literal notranslate"><span class="pre">None</span></code>
if no version was published.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> it assumes you start from scratch</p></li>
<li><p><strong>cache_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – cache folder where databases are stored.
If not set <a class="reference internal" href="audb.default_cache_root.html#audb.default_cache_root" title="audb.default_cache_root"><code class="xref py py-meth docutils literal notranslate"><span class="pre">audb.default_cache_root()</span></code></a> is used.
Only used to read the dependencies of the previous version</p></li>
<li><p><strong>num_workers</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – number of parallel jobs or 1 for sequential
processing. If <code class="docutils literal notranslate"><span class="pre">None</span></code> will be set to the number of
processors on the machine multiplied by 5</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – show debug messages</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="audb.Dependencies.html#audb.Dependencies" title="audb.core.dependencies.Dependencies"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependencies</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dependency object</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if version already exists</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if database tables reference non-existing files</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if database attachment path does not exist,
    is a symlink,
    is empty,
    or contains an empty sub-folder</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if database in <code class="docutils literal notranslate"><span class="pre">db_root</span></code> depends on other version
    as indicated by <code class="docutils literal notranslate"><span class="pre">previous_version</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if database is not portable,
    see <code class="xref py py-meth docutils literal notranslate"><span class="pre">audformat.Database.is_portable()</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if non-standard formats like MP3 and MP4 are published,
    but sox and/or mediafile is not installed</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if the type of a database file changes,
    e.g. from media to attachment</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if a new media file
    has an uppercase letter in its file extension</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – if database contains tables,
    misc tables, or attachments
    that are stored under an ID
    using a char not in <code class="docutils literal notranslate"><span class="pre">'[A-Za-z0-9._-]'</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – if <code class="docutils literal notranslate"><span class="pre">version</span></code> or <code class="docutils literal notranslate"><span class="pre">previous_version</span></code>
    cannot be parsed by <a class="reference external" href="https://audeering.github.io/audeer/api/audeer.StrictVersion.html#audeer.StrictVersion" title="(in audeer vv2.2.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">audeer.StrictVersion</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – if <code class="docutils literal notranslate"><span class="pre">previous_version</span></code> &gt;= <code class="docutils literal notranslate"><span class="pre">version</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="audb.remove_media.html" class="btn btn-neutral float-right" title="remove_media()" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="audb.load_to.html" class="btn btn-neutral float-left" title="load_to()" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div>
    <p>
        
        
        
          Built with <a href="https://www.sphinx-doc.org">Sphinx</a> on 2024/11/18 using the <a href="https://github.com/audeering/sphinx-audeering-theme/">audEERING theme</a>
        
    </p>
  </div>

  <div role="contentinfo">
    <p>
        
      &copy; 2020-2024 audEERING GmbH
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  



  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>